<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Taylor Swift Concert Visualization</title>
    <style> body { margin: 0; } </style>
    <script src="//unpkg.com/d3-dsv"></script>
    <script src="//unpkg.com/index-array-by"></script>
    <script src="//unpkg.com/globe.gl"></script>
</head>
<body>
    <div id="globeViz"></div>

    <script>
        const ARC_REL_LEN = 0.4; // relative to whole arc
        const FLIGHT_TIME = 1000;
        const NUM_RINGS = 3;
        const RINGS_MAX_R = 5; // deg
        const RING_PROPAGATION_SPEED = 5; // deg/sec

        const globe = Globe()
            .globeImageUrl('//unpkg.com/three-globe/example/img/earth-night.jpg')
            .backgroundImageUrl('//unpkg.com/three-globe@2.31.0/example/img/earth-blue-marble.jpg')
            .arcColor(() => 'darkOrange')
            .pointOfView({ lat: 39.9334, lng: 32.8597, altitude: 2 })
            .arcDashLength(ARC_REL_LEN)
            .arcDashGap(0)
            .arcDashInitialGap(1)
            .arcDashAnimateTime(FLIGHT_TIME)
            .arcsTransitionDuration(0)
            .ringColor(() => t => `rgba(255,100,50,${1-t})`)
            .ringMaxRadius(RINGS_MAX_R)
            .ringPropagationSpeed(RING_PROPAGATION_SPEED)
            .ringRepeatPeriod(FLIGHT_TIME * ARC_REL_LEN / NUM_RINGS)
            (document.getElementById('globeViz'));

        const concerts = [
            {
                "şarkıcı": "TAYLOR SWIFT",
                "turne_adı": "THE ERAS TOUR",
                "uluslararası_tarihler": [
                    {
                        "id": 1001,
                        "tarih": "THU, MAY 09, 2024",
                        "konser_yeri": "PARIS LA DÉFENSE ARENA",
                        "destekleyen_sanatçı": "Paramore",
                        "şehir": "Paris",
                        "ülke": "France",
                        "başlangıç_koordinatları": { "lat": 40.7128, "lng": -74.0060 }, // Amerika'nın koordinatları (New York)
                        "gidiş_koordinatları": { "lat": 48.8566, "lng": 2.3522 } // Paris'in koordinatları
                    },
                    {
                        "id": 1002,
                        "tarih": "FRI, MAY 10, 2024",
                        "konser_yeri": "BERLIN STADIUM",
                        "destekleyen_sanatçı": "Paramore",
                        "şehir": "Berlin",
                        "ülke": "Germany",
                        "başlangıç_koordinatları": { "lat": 40.7128, "lng": -74.0060 }, // Amerika'nın koordinatları (New York)
                        "gidiş_koordinatları": { "lat": 52.5200, "lng": 13.4050 } // Berlin'in koordinatları
                    },
                    {
                        "id": 1003,
                        "tarih": "SAT, MAY 11, 2024",
                        "konser_yeri": "LONDON O2 ARENA",
                        "destekleyen_sanatçı": "Paramore",
                        "şehir": "London",
                        "ülke": "United Kingdom",
                        "başlangıç_koordinatları": { "lat": 40.7128, "lng": -74.0060 }, // Amerika'nın koordinatları (New York)
                        "gidiş_koordinatları": { "lat": 51.5074, "lng": -0.1278 } // Londra'nın koordinatları
                    },
                    {
                        "id": 1004,
                        "tarih": "SUN, MAY 12, 2024",
                        "konser_yeri": "SYDNEY OPERA HOUSE",
                        "destekleyen_sanatçı": "Paramore",
                        "şehir": "Sydney",
                        "ülke": "Australia",
                        "başlangıç_koordinatları": { "lat": 40.7128, "lng": -74.0060 }, // Amerika'nın koordinatları (New York)
                        "gidiş_koordinatları": { "lat": -33.8688, "lng": 151.2093 } // Sidney'nin koordinatları
                    }
                ]
            }
        ];

        concerts.forEach(concert => {
            concert.uluslararası_tarihler.forEach(({ konser_yeri, şehir, ülke, başlangıç_koordinatları, gidiş_koordinatları }) => {
                const { lat: startLat, lng: startLng } = başlangıç_koordinatları;
                const { lat: endLat, lng: endLng } = gidiş_koordinatları;
                
                const arc = { startLat, startLng, endLat, endLng };
                globe.arcsData([...globe.arcsData(), arc]);

                const srcRing = { lat: startLat, lng: startLng };
                globe.ringsData([...globe.ringsData(), srcRing]);

                const targetRing = { lat: endLat, lng: endLng };
                globe.ringsData([...globe.ringsData(), targetRing]);
            });
        });
    </script>
</body>
</html>
